# Story verify command allowlist (exact match per line).
# Add or update entries as needed; require human review via RPH_ALLOW_HARNESS_EDIT=1.

bash -n plans/verify.sh
bash plans/tests/test_pr_gate.sh
bash plans/tests/test_workflow_allowlist_coverage.sh
cargo test --workspace
cargo test -p soldier_infra
cargo test -p soldier_core --test test_dispatch_map
cargo test -p soldier_core --test test_idempotency
cargo test -p soldier_core --test test_instrument_cache_ttl
cargo test -p soldier_core --test test_instrument_cache_ttl test_instrument_cache_ttl_blocks_opens_allows_closes
cargo test -p soldier_core --test test_instrument_cache_ttl test_stale_instrument_cache_sets_degraded
cargo test -p soldier_core --test test_instrument_kind_mapping
cargo test -p soldier_core --test test_label
cargo test -p soldier_core --test test_label_match
cargo test -p soldier_core --test test_order_size
cargo test -p soldier_core --test test_quantize
cargo test -p soldier_core --test test_preflight
cargo test -p soldier_core --test test_post_only_guard
cargo test -p soldier_core --test test_capabilities
cargo test -p soldier_core --test test_liquidity_gate
cargo test -p soldier_core --test test_fee_staleness
cargo test -p soldier_infra --test test_fee_cache
cargo test -p soldier_core --test test_net_edge_gate
cargo test -p soldier_core --test test_pricer
cargo test -p soldier_core --test test_tlsm
cargo test -p soldier_core --test test_gate_ordering
cargo test -p soldier_core --test test_dispatch_chokepoint
cargo test -p soldier_core --test test_intent_determinism
cargo test -p soldier_core --test test_rejection_side_effects
cargo test -p soldier_core --test test_intent_id_propagation
cargo test -p soldier_core --test test_missing_config
cargo test -p soldier_infra --test test_ledger_replay
cargo test -p soldier_infra --test test_trade_id_registry
cargo test -p soldier_infra --test test_dispatch_durability
cargo test -p soldier_infra --test test_config_defaults
cargo test -p soldier_infra --test test_crash_mid_intent
rg -n "cargo test --workspace" plans/verify.sh
rg -n "check_vq_evidence.py" plans/verify.sh
test -f docs/order_size_discovery.md
rg -n "OrderSize" docs/order_size_discovery.md
test -f docs/dispatch_map_discovery.md
rg -n "dispatch" docs/dispatch_map_discovery.md

# Phase 0 documentation evidence checks
test -s docs/launch_policy.md
test -s evidence/phase0/policy/launch_policy_snapshot.md
test -s docs/env_matrix.md
test -s evidence/phase0/env/env_matrix_snapshot.md
test -s docs/keys_and_secrets.md
test -s docs/break_glass_runbook.md
test -s evidence/phase0/break_glass/runbook_snapshot.md
test -s evidence/phase0/break_glass/drill.md
test -s evidence/phase0/break_glass/log_excerpt.txt
test -s docs/health_endpoint.md
cargo test -p soldier_infra --test test_health
python -c "import json; json.load(open('evidence/phase0/keys/key_scope_probe.json'))"
